{% extends "base.html" %}
{% block content %}
  <div class="main-grid">
    <section class="card">
      <div class="card-title">Latest updates</div>
      <div class="card-sub">Share this page with your client.</div>
      <div class="hr"></div>

      {% for p in posts %}
        <article class="post">
          <div class="meta">{{ p['created_at'] }}</div>
          <div class="title">{{ p['title'] }}</div>
          <div class="body">{{ p['body']|replace('\n', '<br>')|safe }}</div>
          {% if p['image_path'] %}
            <img src="{{ url_for('static', filename=p['image_path']) }}" alt="Photo for {{ p['title'] }}" />
          {% endif %}
          {% if not loop.last %}<div class="hr"></div>{% endif %}
        </article>
      {% else %}
        <div class="card-sub">No posts yet.</div>
      {% endfor %}
    </section>

    <aside class="card">
      <div class="card-title">About</div>
      <div class="card-sub">Quick daily notes of whatâ€™s been cleaned, with optional photos. Clients see updates here.</div>
      <div class="hr"></div>
      <div>Status:
        {% if not (config.get('SMTP_HOST') and config.get('SMTP_USER') and config.get('SMTP_PASS') and config.get('CLIENT_EMAILS')) %}
          <span class="badge">Notifications OFF</span>
        {% else %}
          <span class="badge">Notifications ON</span>
        {% endif %}
      </div>
    </aside>
  </div>
{% endblock %}